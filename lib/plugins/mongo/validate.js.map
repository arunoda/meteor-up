{"version":3,"sources":["../../../src/plugins/mongo/validate.js"],"names":["config","combineErrorDetails","serversExist","addLocation","VALIDATE_OPTIONS","details","validationErrors","validate","mongo","schema","servers","object","keys","oplog","bool","port","number","version","string","required"],"mappings":";;;;;;kBAYe,UACbA,MADa,QAQb;AAAA,MALEC,mBAKF,QALEA,mBAKF;AAAA,MAJEC,YAIF,QAJEA,YAIF;AAAA,MAHEC,WAGF,QAHEA,WAGF;AAAA,MAFEC,gBAEF,QAFEA,gBAEF;;AACA,MAAIC,UAAU,EAAd;;AAEA,MAAIC,mBAAmB,cAAIC,QAAJ,CAAaP,OAAOQ,KAApB,EAA2BC,MAA3B,EAAmCL,gBAAnC,CAAvB;AACAC,YAAUJ,oBAAoBI,OAApB,EAA6BC,gBAA7B,CAAV;AACAD,YAAUJ,oBACRI,OADQ,EAERH,aAAaF,OAAOU,OAApB,EAA6BV,OAAOQ,KAAP,CAAaE,OAA1C,CAFQ,CAAV;AAIA,SAAOP,YAAYE,OAAZ,EAAqB,OAArB,CAAP;AACD,C;;AA9BD;;;;;;AAEA,IAAMI,SAAS,cAAIE,MAAJ,GAAaC,IAAb,CAAkB;AAC/B;AACA;AACA;AACAC,SAAO,cAAIC,IAAJ,EAJwB;AAK/BC,QAAM,cAAIC,MAAJ,EALyB;AAM/BC,WAAS,cAAIC,MAAJ,EANsB;AAO/BR,WAAS,cAAIC,MAAJ,GAAaC,IAAb,GAAoBO,QAApB;AAPsB,CAAlB,CAAf","file":"validate.js","sourcesContent":["import joi from 'joi';\r\n\r\nconst schema = joi.object().keys({\r\n  // TODO: mongo.oplog and mongo.port is unused,\r\n  // but was part of the example config.\r\n  // decide what to do with it\r\n  oplog: joi.bool(),\r\n  port: joi.number(),\r\n  version: joi.string(),\r\n  servers: joi.object().keys().required()\r\n});\r\n\r\nexport default function(\r\n  config,\r\n  {\r\n    combineErrorDetails,\r\n    serversExist,\r\n    addLocation,\r\n    VALIDATE_OPTIONS\r\n  }\r\n) {\r\n  let details = [];\r\n\r\n  let validationErrors = joi.validate(config.mongo, schema, VALIDATE_OPTIONS);\r\n  details = combineErrorDetails(details, validationErrors);\r\n  details = combineErrorDetails(\r\n    details,\r\n    serversExist(config.servers, config.mongo.servers)\r\n  );\r\n  return addLocation(details, 'mongo');\r\n}\r\n"]}